import{s as C,n as q,o as R}from"../chunks/scheduler.e108d1fd.js";import{S as F,i as O,g as $,s as x,r as k,h as _,j as D,y as P,c as E,u as L,f as p,k as v,l as U,a as j,x as f,v as T,d as b,t as A,w as I}from"../chunks/index.e36b9a99.js";import{b as u}from"../chunks/paths.c80ee5c8.js";import{L as V,A as H}from"../chunks/AuthResponse.db26226c.js";import{L as J,a as M,E as B}from"../chunks/ErrorResponseDto.e0bb0d90.js";import{a as z}from"../chunks/js.cookie.edb2da2a.js";import{U as G}from"../chunks/usertypes.f975be66.js";function N(y){let s,r,t,a,o="Oktatói belépés",i,n,w,l,d,m,h;return n=new V({props:{regUrl:`${u}/kozos/regisztracio`,loginHandler:y[0]}}),l=new J({}),m=new M({}),{c(){s=$("div"),r=$("div"),t=$("div"),a=$("h4"),a.textContent=o,i=x(),k(n.$$.fragment),w=x(),k(l.$$.fragment),d=x(),k(m.$$.fragment),this.h()},l(e){s=_(e,"DIV",{class:!0});var c=D(s);r=_(c,"DIV",{class:!0,style:!0});var S=D(r);t=_(S,"DIV",{class:!0});var g=D(t);a=_(g,"H4",{class:!0,"data-svelte-h":!0}),P(a)!=="svelte-1khjtg7"&&(a.textContent=o),i=E(g),L(n.$$.fragment,g),g.forEach(p),S.forEach(p),w=E(c),L(l.$$.fragment,c),c.forEach(p),d=E(e),L(m.$$.fragment,e),this.h()},h(){v(a,"class","card-title"),v(t,"class","card-body svelte-1uctxqa"),v(r,"class","card svelte-1uctxqa"),U(r,"width","20rem"),v(s,"class","container logo-container svelte-1uctxqa")},m(e,c){j(e,s,c),f(s,r),f(r,t),f(t,a),f(t,i),T(n,t,null),f(s,w),T(l,s,null),j(e,d,c),T(m,e,c),h=!0},p:q,i(e){h||(b(n.$$.fragment,e),b(l.$$.fragment,e),b(m.$$.fragment,e),h=!0)},o(e){A(n.$$.fragment,e),A(l.$$.fragment,e),A(m.$$.fragment,e),h=!1},d(e){e&&(p(s),p(d)),I(n),I(l),I(m,e)}}}function K(y){const s=async t=>{const a={...t,userType:G.Teacher};try{const o=await fetch(u+"/api/auth",{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});if(o.status===200){const i=await H.parseAsync(await o.json()),n=new Date(new Date().getTime()+i.expiresIn*1e3);z.set("token",i.accessToken,{expires:n,path:"/oktato/",secure:!0,sameSite:"strict"}),window.location.href=`${u}/oktato/kezdolap`}else{const i=await o.json(),n=await B.safeParseAsync(i);return n.success?n.data.errorMessage:"Ismeretlen hiba történt!"}}catch(o){return console.error(o),"Ismeretlen hiba történt!"}},r=async()=>{const t=z.get("token");if(!(t===void 0||t.length===0))try{(await fetch(u+"/api/profile",{method:"GET",headers:{Authorization:`Bearer ${t}`}})).status===200&&(window.location.href=`${u}/oktato/kezdolap`)}catch(a){console.error("Auth check failed with error: ",a)}};return R(async()=>{r()}),[s]}class se extends F{constructor(s){super(),O(this,s,K,N,C,{})}}export{se as component};
