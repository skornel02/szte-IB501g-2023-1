import{s as F,n as S,o as J}from"../chunks/scheduler.572f10a3.js";import{S as H,i as P,g as h,h as d,I as U,k as $,a as T,f,s as k,r as D,j,c as L,u as A,l as M,C as u,v as C,d as I,t as b,w as E}from"../chunks/index.21ac587f.js";import{b as v}from"../chunks/paths.9a0de800.js";import{L as O,A as B}from"../chunks/AuthResponse.24359466.js";import{L as G,a as N}from"../chunks/LoginLogo.5563c2f1.js";import{a as R}from"../chunks/js.cookie.edb2da2a.js";import{U as K}from"../chunks/usertypes.d012f79a.js";import{E as Q}from"../chunks/ErrorResponseDto.3330ec0e.js";import{g as V}from"../chunks/navigation.5e769456.js";function W(g){let t,n="Diák hitel 3 most már elérhető!";return{c(){t=h("div"),t.textContent=n,this.h()},l(s){t=d(s,"DIV",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-19qhtb4"&&(t.textContent=n),this.h()},h(){$(t,"class","alert alert-warning svelte-q3eogl")},m(s,a){T(s,t,a)},p:S,i:S,o:S,d(s){s&&f(t)}}}class X extends H{constructor(t){super(),P(this,t,null,W,F,{})}}function Y(g){let t,n,s,a,i="Hallgatói belépés",l,r,q,c,_,m,x,p,y;return r=new O({props:{regUrl:`${v}/kozos/regisztracio`,loginHandler:g[0]}}),c=new G({}),m=new X({}),p=new N({}),{c(){t=h("div"),n=h("div"),s=h("div"),a=h("h4"),a.textContent=i,l=k(),D(r.$$.fragment),q=k(),D(c.$$.fragment),_=k(),D(m.$$.fragment),x=k(),D(p.$$.fragment),this.h()},l(e){t=d(e,"DIV",{class:!0});var o=j(t);n=d(o,"DIV",{class:!0,style:!0});var z=j(n);s=d(z,"DIV",{class:!0});var w=j(s);a=d(w,"H4",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-iu1xvd"&&(a.textContent=i),l=L(w),A(r.$$.fragment,w),w.forEach(f),z.forEach(f),q=L(o),A(c.$$.fragment,o),o.forEach(f),_=L(e),A(m.$$.fragment,e),x=L(e),A(p.$$.fragment,e),this.h()},h(){$(a,"class","card-title"),$(s,"class","card-body svelte-1uctxqa"),$(n,"class","card svelte-1uctxqa"),M(n,"width","20rem"),$(t,"class","container logo-container svelte-1uctxqa")},m(e,o){T(e,t,o),u(t,n),u(n,s),u(s,a),u(s,l),C(r,s,null),u(t,q),C(c,t,null),T(e,_,o),C(m,e,o),T(e,x,o),C(p,e,o),y=!0},p:S,i(e){y||(I(r.$$.fragment,e),I(c.$$.fragment,e),I(m.$$.fragment,e),I(p.$$.fragment,e),y=!0)},o(e){b(r.$$.fragment,e),b(c.$$.fragment,e),b(m.$$.fragment,e),b(p.$$.fragment,e),y=!1},d(e){e&&(f(t),f(_),f(x)),E(r),E(c),E(m,e),E(p,e)}}}function Z(g){const t=async s=>{const a={...s,userType:K.Student};try{const i=await fetch(v+"/api/auth",{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});if(i.status===200){const l=await B.parseAsync(await i.json()),r=new Date(new Date().getTime()+l.expiresIn*1e3);R.set("hallgato-token",l.accessToken,{expires:r,path:"/",secure:!0,sameSite:"strict"}),V(`${v}/hallgato/kezdolap`)}else{const l=await i.json(),r=await Q.safeParseAsync(l);return r.success?r.data.errorMessage:"Ismeretlen hiba történt!"}}catch(i){return console.error(i),"Ismeretlen hiba történt!"}},n=async()=>{const s=R.get("hallgato-token");if(!(s===void 0||s.length===0))try{(await fetch(v+"/api/profile",{method:"GET",headers:{Authorization:`Bearer ${s}`}})).status===200&&V(`${v}/hallgato/kezdolap`)}catch(a){console.error("Auth check failed with error: ",a)}};return J(async()=>{n()}),[t]}class ce extends H{constructor(t){super(),P(this,t,Z,Y,F,{})}}export{ce as component};
