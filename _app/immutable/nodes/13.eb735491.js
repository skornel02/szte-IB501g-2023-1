import{s as q,n as R,o as F}from"../chunks/scheduler.572f10a3.js";import{S as O,i as P,g as $,s as x,r as w,h as _,j as D,I as U,c as E,u as I,f as p,k as v,l as V,a as j,C as f,v as L,d as T,t as b,w as A}from"../chunks/index.21ac587f.js";import{b as u}from"../chunks/paths.60bbcda8.js";import{L as H,A as J}from"../chunks/AuthResponse.fdd3d4b6.js";import{L as M,a as B}from"../chunks/LoginLogo.71f7ba83.js";import{a as C}from"../chunks/js.cookie.edb2da2a.js";import{U as G}from"../chunks/usertypes.f975be66.js";import{E as N}from"../chunks/ErrorResponseDto.3330ec0e.js";import{g as z}from"../chunks/navigation.52a89c2a.js";function K(y){let s,o,t,a,n="Oktatói belépés",i,r,k,l,d,m,g;return r=new H({props:{regUrl:`${u}/kozos/regisztracio`,loginHandler:y[0]}}),l=new M({}),m=new B({}),{c(){s=$("div"),o=$("div"),t=$("div"),a=$("h4"),a.textContent=n,i=x(),w(r.$$.fragment),k=x(),w(l.$$.fragment),d=x(),w(m.$$.fragment),this.h()},l(e){s=_(e,"DIV",{class:!0});var c=D(s);o=_(c,"DIV",{class:!0,style:!0});var S=D(o);t=_(S,"DIV",{class:!0});var h=D(t);a=_(h,"H4",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-1khjtg7"&&(a.textContent=n),i=E(h),I(r.$$.fragment,h),h.forEach(p),S.forEach(p),k=E(c),I(l.$$.fragment,c),c.forEach(p),d=E(e),I(m.$$.fragment,e),this.h()},h(){v(a,"class","card-title"),v(t,"class","card-body svelte-1uctxqa"),v(o,"class","card svelte-1uctxqa"),V(o,"width","20rem"),v(s,"class","container logo-container svelte-1uctxqa")},m(e,c){j(e,s,c),f(s,o),f(o,t),f(t,a),f(t,i),L(r,t,null),f(s,k),L(l,s,null),j(e,d,c),L(m,e,c),g=!0},p:R,i(e){g||(T(r.$$.fragment,e),T(l.$$.fragment,e),T(m.$$.fragment,e),g=!0)},o(e){b(r.$$.fragment,e),b(l.$$.fragment,e),b(m.$$.fragment,e),g=!1},d(e){e&&(p(s),p(d)),A(r),A(l),A(m,e)}}}function Q(y){const s=async t=>{const a={...t,userType:G.Teacher};try{const n=await fetch(u+"/api/auth",{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});if(n.status===200){const i=await J.parseAsync(await n.json()),r=new Date(new Date().getTime()+i.expiresIn*1e3);C.set("oktato-token",i.accessToken,{expires:r,path:"/",secure:!0,sameSite:"strict"}),await z(`${u}/oktato/kezdolap`)}else{const i=await n.json(),r=await N.safeParseAsync(i);return r.success?r.data.errorMessage:"Ismeretlen hiba történt!"}}catch(n){return console.error(n),"Ismeretlen hiba történt!"}},o=async()=>{const t=C.get("oktato-token");if(!(t===void 0||t.length===0))try{(await fetch(u+"/api/profile",{method:"GET",headers:{Authorization:`Bearer ${t}`}})).status===200&&z(`${u}/oktato/kezdolap`)}catch(a){console.error("Auth check failed with error: ",a)}};return F(async()=>{o()}),[s]}class oe extends O{constructor(s){super(),P(this,s,Q,K,q,{})}}export{oe as component};
