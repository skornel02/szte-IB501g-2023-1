import{s as F,f as h,g as d,L as H,j as $,i as S,C as T,d as f,a as k,h as j,c as L,k as J,x as u,o as M}from"../chunks/scheduler.21bd8612.js";import{S as P,i as U,b as D,d as b,m as A,a as C,t as E,e as I}from"../chunks/index.2510bc2d.js";import{b as v}from"../chunks/paths.cbaa310c.js";import{L as O,A as B}from"../chunks/AuthResponse.e15510ef.js";import{L as G,a as N}from"../chunks/LoginLogo.bce037a4.js";import{a as R}from"../chunks/js.cookie.edb2da2a.js";import{U as K}from"../chunks/usertypes.d012f79a.js";import{E as Q}from"../chunks/ErrorResponseDto.3330ec0e.js";import{g as V}from"../chunks/navigation.53551334.js";function W(g){let t,n="Diák hitel 3 most már elérhető!";return{c(){t=h("div"),t.textContent=n,this.h()},l(s){t=d(s,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-19qhtb4"&&(t.textContent=n),this.h()},h(){$(t,"class","alert alert-warning svelte-q3eogl")},m(s,a){S(s,t,a)},p:T,i:T,o:T,d(s){s&&f(t)}}}class X extends P{constructor(t){super(),U(this,t,null,W,F,{})}}function Y(g){let t,n,s,a,i="Hallgatói belépés",l,r,q,c,_,m,x,p,y;return r=new O({props:{regUrl:`${v}/kozos/regisztracio`,loginHandler:g[0]}}),c=new G({}),m=new X({}),p=new N({}),{c(){t=h("div"),n=h("div"),s=h("div"),a=h("h4"),a.textContent=i,l=k(),D(r.$$.fragment),q=k(),D(c.$$.fragment),_=k(),D(m.$$.fragment),x=k(),D(p.$$.fragment),this.h()},l(e){t=d(e,"DIV",{class:!0});var o=j(t);n=d(o,"DIV",{class:!0,style:!0});var z=j(n);s=d(z,"DIV",{class:!0});var w=j(s);a=d(w,"H4",{class:!0,"data-svelte-h":!0}),H(a)!=="svelte-iu1xvd"&&(a.textContent=i),l=L(w),b(r.$$.fragment,w),w.forEach(f),z.forEach(f),q=L(o),b(c.$$.fragment,o),o.forEach(f),_=L(e),b(m.$$.fragment,e),x=L(e),b(p.$$.fragment,e),this.h()},h(){$(a,"class","card-title"),$(s,"class","card-body svelte-1uctxqa"),$(n,"class","card svelte-1uctxqa"),J(n,"width","20rem"),$(t,"class","container logo-container svelte-1uctxqa")},m(e,o){S(e,t,o),u(t,n),u(n,s),u(s,a),u(s,l),A(r,s,null),u(t,q),A(c,t,null),S(e,_,o),A(m,e,o),S(e,x,o),A(p,e,o),y=!0},p:T,i(e){y||(C(r.$$.fragment,e),C(c.$$.fragment,e),C(m.$$.fragment,e),C(p.$$.fragment,e),y=!0)},o(e){E(r.$$.fragment,e),E(c.$$.fragment,e),E(m.$$.fragment,e),E(p.$$.fragment,e),y=!1},d(e){e&&(f(t),f(_),f(x)),I(r),I(c),I(m,e),I(p,e)}}}function Z(g){const t=async s=>{const a={...s,userType:K.Student};try{const i=await fetch(v+"/api/auth",{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});if(i.status===200){const l=await B.parseAsync(await i.json()),r=new Date(new Date().getTime()+l.expiresIn*1e3);R.set("hallgato-token",l.accessToken,{expires:r,path:"/",secure:!0,sameSite:"strict"}),V(`${v}/hallgato/kezdolap`)}else{const l=await i.json(),r=await Q.safeParseAsync(l);return r.success?r.data.errorMessage:"Ismeretlen hiba történt!"}}catch(i){return console.error(i),"Ismeretlen hiba történt!"}},n=async()=>{const s=R.get("hallgato-token");if(!(s===void 0||s.length===0))try{(await fetch(v+"/api/profile",{method:"GET",headers:{Authorization:`Bearer ${s}`}})).status===200&&V(`${v}/hallgato/kezdolap`)}catch(a){console.error("Auth check failed with error: ",a)}};return M(async()=>{n()}),[t]}class ce extends P{constructor(t){super(),U(this,t,Z,Y,F,{})}}export{ce as component};
